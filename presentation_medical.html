<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gradient Checkpointing for 3D Medical Imaging</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0066cc 0%, #00a86b 100%);
            overflow: hidden;
        }

        .presentation-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .slide {
            width: 90%;
            max-width: 1200px;
            height: 85vh;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 60px;
            display: none;
            animation: slideIn 0.5s ease-out;
            overflow-y: auto;
        }

        .slide.active {
            display: block;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .slide h1 {
            color: #2d3748;
            font-size: 3em;
            margin-bottom: 30px;
            border-bottom: 4px solid #0066cc;
            padding-bottom: 20px;
        }

        .slide h2 {
            color: #4a5568;
            font-size: 2.2em;
            margin-bottom: 25px;
            margin-top: 30px;
        }

        .slide h3 {
            color: #0066cc;
            font-size: 1.8em;
            margin-bottom: 20px;
            margin-top: 25px;
        }

        .slide p {
            color: #4a5568;
            font-size: 1.3em;
            line-height: 1.8;
            margin-bottom: 20px;
        }

        .slide ul {
            margin-left: 30px;
            margin-bottom: 20px;
        }

        .slide li {
            color: #4a5568;
            font-size: 1.2em;
            line-height: 1.8;
            margin-bottom: 10px;
        }

        .navigation {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .nav-btn {
            background: #0066cc;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .nav-btn:hover {
            background: #0052a3;
            transform: scale(1.05);
        }

        .nav-btn:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            transform: scale(1);
        }

        .slide-counter {
            color: white;
            font-size: 1.2em;
            font-weight: bold;
            padding: 0 20px;
        }

        .title-slide {
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .title-slide h1 {
            font-size: 3.5em;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #0066cc 0%, #00a86b 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            border: none;
        }

        .title-slide p {
            font-size: 1.8em;
            color: #718096;
        }

        .subtitle {
            font-size: 1.4em;
            color: #a0aec0;
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            font-size: 1.1em;
        }

        th {
            background: linear-gradient(135deg, #0066cc 0%, #00a86b 100%);
            color: white;
            padding: 15px;
            text-align: left;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #e2e8f0;
            color: #4a5568;
        }

        tr:hover {
            background: #f7fafc;
        }

        .chart-container {
            margin: 30px 0;
            padding: 20px;
            background: #f7fafc;
            border-radius: 12px;
        }

        .bar-chart {
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            height: 300px;
            margin: 20px 0;
        }

        .bar {
            width: 80px;
            background: linear-gradient(180deg, #0066cc 0%, #00a86b 100%);
            border-radius: 8px 8px 0 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            color: white;
            font-weight: bold;
            padding: 10px;
            transition: all 0.3s;
        }

        .bar:hover {
            transform: scale(1.05);
        }

        .bar-label {
            margin-top: 10px;
            color: #4a5568;
            font-size: 0.9em;
            text-align: center;
        }

        .highlight {
            background: #fef3c7;
            padding: 2px 6px;
            border-radius: 4px;
        }

        .medical-icon {
            font-size: 2em;
            margin-right: 10px;
            vertical-align: middle;
        }

        .volume-viz {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 30px 0;
        }

        .volume-box {
            width: 150px;
            height: 150px;
            background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 100%);
            border: 3px solid #0066cc;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #0066cc;
        }

        .memory-comparison {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
            margin: 30px 0;
        }

        .memory-box {
            padding: 25px;
            border-radius: 12px;
            text-align: center;
        }

        .memory-box.standard {
            background: #fee2e2;
            border: 2px solid #dc2626;
        }

        .memory-box.checkpointed {
            background: #dcfce7;
            border: 2px solid #16a34a;
        }

        .memory-value {
            font-size: 2.5em;
            font-weight: bold;
            margin: 10px 0;
        }

        .memory-label {
            font-size: 1.2em;
            color: #4a5568;
        }

        .code-snippet {
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
            overflow-x: auto;
        }

        .code-snippet .keyword {
            color: #f472b6;
        }

        .code-snippet .string {
            color: #a5f3fc;
        }

        .code-snippet .comment {
            color: #64748b;
        }
    </style>
</head>
<body>
    <div class="presentation-container">
        <!-- Slide 1: Title -->
        <div class="slide title-slide active">
            <h1>üß† Gradient Checkpointing for 3D Medical Imaging</h1>
            <p>Enabling Deep Learning on Large Volumetric Data</p>
            <p class="subtitle">Memory-Efficient Training for MRI, CT, and Medical Image Analysis</p>
        </div>

        <!-- Slide 2: The Challenge -->
        <div class="slide">
            <h1>üè• The Challenge in Medical Imaging</h1>
            <h2>Why 3D Medical Imaging is Memory-Intensive</h2>
            <ul>
                <li><span class="medical-icon">üß†</span><strong>Brain MRI:</strong> 256√ó256√ó256 voxels = 16.7M voxels per volume</li>
                <li><span class="medical-icon">‚ù§Ô∏è</span><strong>Cardiac CT:</strong> 512√ó512√ó64 slices = 16.7M voxels</li>
                <li><span class="medical-icon">ü´Å</span><strong>Chest CT:</strong> 512√ó512√ó400 slices = 104.8M voxels</li>
            </ul>
            
            <div class="volume-viz">
                <div class="volume-box">
                    <div>128¬≥</div>
                    <div>2.1M voxels</div>
                    <div>~8MB</div>
                </div>
                <div class="volume-box">
                    <div>256¬≥</div>
                    <div>16.7M voxels</div>
                    <div>~64MB</div>
                </div>
                <div class="volume-box">
                    <div>512¬≥</div>
                    <div>134M voxels</div>
                    <div>~512MB</div>
                </div>
            </div>
            
            <p><strong>Problem:</strong> Deep networks (U-Net, V-Net) store activations at every layer, quickly exhausting GPU memory!</p>
        </div>

        <!-- Slide 3: Solution Overview -->
        <div class="slide">
            <h1>üí° The Solution: Gradient Checkpointing</h1>
            
            <h2>Core Concept</h2>
            <p>Trade compute time for memory by selectively storing activations</p>
            
            <div class="memory-comparison">
                <div class="memory-box standard">
                    <h3>Standard Training</h3>
                    <div class="memory-value">16 GB</div>
                    <div class="memory-label">Peak Memory</div>
                    <p>Stores all activations</p>
                    <p>Fast but memory-hungry</p>
                </div>
                <div class="memory-box checkpointed">
                    <h3>With Checkpointing</h3>
                    <div class="memory-value">6 GB</div>
                    <div class="memory-label">Peak Memory</div>
                    <p>Recomputes activations</p>
                    <p>60% memory savings!</p>
                </div>
            </div>
            
            <p><strong>Key Benefit:</strong> Process 2-4√ó larger volumes or increase batch size</p>
        </div>

        <!-- Slide 4: How It Works -->
        <div class="slide">
            <h1>‚öôÔ∏è How Gradient Checkpointing Works</h1>
            
            <h2>3D U-Net Example</h2>
            
            <div class="code-snippet">
                <span class="comment"># Standard forward pass - stores all activations</span>
                enc1 = encoder_block1(x)     <span class="comment"># 128¬≥ √ó 32 channels = 2GB</span>
                enc2 = encoder_block2(enc1)  <span class="comment"># 64¬≥ √ó 64 channels = 1GB</span>
                enc3 = encoder_block3(enc2)  <span class="comment"># 32¬≥ √ó 128 channels = 0.5GB</span>
                
                <span class="comment"># With checkpointing - recomputes during backward</span>
                enc1 = <span class="keyword">checkpoint</span>(encoder_block1, x)  <span class="comment"># Not stored!</span>
                enc2 = <span class="keyword">checkpoint</span>(encoder_block2, enc1) <span class="comment"># Not stored!</span>
                enc3 = <span class="keyword">checkpoint</span>(encoder_block3, enc2) <span class="comment"># Not stored!</span>
            </div>
            
            <h3>The Trade-off</h3>
            <ul>
                <li>‚úÖ <strong>Memory:</strong> O(‚àön) instead of O(n)</li>
                <li>‚è±Ô∏è <strong>Compute:</strong> ~30% slower (acceptable for memory-limited scenarios)</li>
                <li>üéØ <strong>Result:</strong> Identical gradients and model accuracy</li>
            </ul>
        </div>

        <!-- Slide 5: Medical Architectures -->
        <div class="slide">
            <h1>üèóÔ∏è Checkpointing Strategies for Medical Architectures</h1>
            
            <table>
                <thead>
                    <tr>
                        <th>Architecture</th>
                        <th>Use Case</th>
                        <th>Checkpoint Strategy</th>
                        <th>Memory Savings</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>3D U-Net</strong></td>
                        <td>Brain segmentation</td>
                        <td>Encoder blocks + bottleneck</td>
                        <td>50-60%</td>
                    </tr>
                    <tr>
                        <td><strong>V-Net</strong></td>
                        <td>Cardiac analysis</td>
                        <td>Residual blocks</td>
                        <td>40-50%</td>
                    </tr>
                    <tr>
                        <td><strong>nnU-Net</strong></td>
                        <td>Universal segmentation</td>
                        <td>Deep encoder layers</td>
                        <td>60-70%</td>
                    </tr>
                    <tr>
                        <td><strong>Attention U-Net</strong></td>
                        <td>Tumor detection</td>
                        <td>Attention gates</td>
                        <td>45-55%</td>
                    </tr>
                </tbody>
            </table>
            
            <h3>Optimal Checkpointing Points</h3>
            <ul>
                <li>üéØ <strong>Bottleneck layers</strong> (highest memory usage)</li>
                <li>üéØ <strong>After downsampling</strong> (encoder path)</li>
                <li>üéØ <strong>Before upsampling</strong> (decoder path)</li>
                <li>üéØ <strong>Skip connections</strong> (selective storage)</li>
            </ul>
        </div>

        <!-- Slide 6: Real-World Results -->
        <div class="slide">
            <h1>üìä Real-World Performance Results</h1>
            
            <h2>Brain MRI Segmentation (256√ó256√ó256)</h2>
            
            <div class="chart-container">
                <div class="bar-chart">
                    <div style="height: 80%">
                        <div class="bar" style="height: 100%">16 GB</div>
                        <div class="bar-label">Standard<br>Training</div>
                    </div>
                    <div style="height: 80%">
                        <div class="bar" style="height: 40%">6.4 GB</div>
                        <div class="bar-label">With<br>Checkpointing</div>
                    </div>
                    <div style="height: 80%">
                        <div class="bar" style="height: 25%">4 GB</div>
                        <div class="bar-label">Checkpoint +<br>Mixed Precision</div>
                    </div>
                </div>
            </div>
            
            <h3>Benchmark Results</h3>
            <table>
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th>Standard</th>
                        <th>Checkpointed</th>
                        <th>Improvement</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Max Volume Size</td>
                        <td>128¬≥</td>
                        <td>256¬≥</td>
                        <td><span class="highlight">8√ó larger</span></td>
                    </tr>
                    <tr>
                        <td>Batch Size</td>
                        <td>1</td>
                        <td>4</td>
                        <td><span class="highlight">4√ó larger</span></td>
                    </tr>
                    <tr>
                        <td>Training Time</td>
                        <td>100%</td>
                        <td>130%</td>
                        <td>30% overhead</td>
                    </tr>
                    <tr>
                        <td>Model Accuracy</td>
                        <td>0.912 Dice</td>
                        <td>0.912 Dice</td>
                        <td>Identical</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Slide 7: Clinical Applications -->
        <div class="slide">
            <h1>üè• Clinical Applications</h1>
            
            <h2>Enabled Use Cases</h2>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                <div>
                    <h3>üß† Neuroimaging</h3>
                    <ul>
                        <li>Whole-brain parcellation (100+ regions)</li>
                        <li>High-resolution DTI tractography</li>
                        <li>Longitudinal atrophy analysis</li>
                        <li>Multi-modal fusion (T1, T2, FLAIR)</li>
                    </ul>
                </div>
                <div>
                    <h3>‚ù§Ô∏è Cardiac Imaging</h3>
                    <ul>
                        <li>4D flow MRI analysis</li>
                        <li>Coronary artery segmentation</li>
                        <li>Myocardial strain mapping</li>
                        <li>Real-time intervention guidance</li>
                    </ul>
                </div>
                <div>
                    <h3>ü´Å Chest Imaging</h3>
                    <ul>
                        <li>Lung nodule detection</li>
                        <li>COVID-19 quantification</li>
                        <li>Emphysema scoring</li>
                        <li>Vessel tree extraction</li>
                    </ul>
                </div>
                <div>
                    <h3>ü¶¥ Musculoskeletal</h3>
                    <ul>
                        <li>Bone segmentation</li>
                        <li>Cartilage thickness mapping</li>
                        <li>Muscle volume analysis</li>
                        <li>Joint space assessment</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Slide 8: Implementation Guide -->
        <div class="slide">
            <h1>üõ†Ô∏è Implementation Guide</h1>
            
            <h2>Quick Start with PyTorch</h2>
            
            <div class="code-snippet">
<span class="keyword">import</span> torch
<span class="keyword">from</span> torch.utils.checkpoint <span class="keyword">import</span> checkpoint

<span class="keyword">class</span> <span class="string">UNet3D</span>(nn.Module):
    <span class="keyword">def</span> forward(self, x):
        <span class="comment"># Standard forward pass</span>
        enc1 = self.encoder1(x)
        enc2 = self.encoder2(enc1)
        
        <span class="comment"># With checkpointing - saves 60% memory!</span>
        enc1 = checkpoint(self.encoder1, x)
        enc2 = checkpoint(self.encoder2, enc1)
        
        <span class="keyword">return</span> self.decoder(enc2)
            </div>
            
            <h3>Best Practices</h3>
            <ul>
                <li>‚úÖ Start with bottleneck layers (highest memory usage)</li>
                <li>‚úÖ Profile your model to identify memory hotspots</li>
                <li>‚úÖ Combine with mixed precision for maximum savings</li>
                <li>‚úÖ Use selective checkpointing for optimal speed/memory trade-off</li>
                <li>‚ö†Ô∏è Don't checkpoint batch normalization layers</li>
                <li>‚ö†Ô∏è Be careful with dropout during checkpointing</li>
            </ul>
        </div>

        <!-- Slide 9: GPU Recommendations -->
        <div class="slide">
            <h1>üñ•Ô∏è Hardware Recommendations</h1>
            
            <h2>GPU Memory Requirements for Medical Imaging</h2>
            
            <table>
                <thead>
                    <tr>
                        <th>GPU</th>
                        <th>Memory</th>
                        <th>Without Checkpointing</th>
                        <th>With Checkpointing</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>RTX 3070</strong></td>
                        <td>8 GB</td>
                        <td>64¬≥ volumes</td>
                        <td><span class="highlight">128¬≥ volumes</span></td>
                    </tr>
                    <tr>
                        <td><strong>V100</strong></td>
                        <td>16 GB</td>
                        <td>128¬≥ volumes</td>
                        <td><span class="highlight">256¬≥ volumes</span></td>
                    </tr>
                    <tr>
                        <td><strong>RTX 3090</strong></td>
                        <td>24 GB</td>
                        <td>192¬≥ volumes</td>
                        <td><span class="highlight">320¬≥ volumes</span></td>
                    </tr>
                    <tr>
                        <td><strong>A100</strong></td>
                        <td>40-80 GB</td>
                        <td>256¬≥ volumes</td>
                        <td><span class="highlight">512¬≥ volumes</span></td>
                    </tr>
                </tbody>
            </table>
            
            <h3>Memory Optimization Strategies</h3>
            <ul>
                <li>üéØ <strong>Level 1:</strong> Mixed precision training (50% savings)</li>
                <li>üéØ <strong>Level 2:</strong> Selective checkpointing (40% additional)</li>
                <li>üéØ <strong>Level 3:</strong> Full checkpointing (60% additional)</li>
                <li>üéØ <strong>Level 4:</strong> Gradient accumulation (process any size)</li>
            </ul>
        </div>

        <!-- Slide 10: Conclusion -->
        <div class="slide">
            <h1>üéØ Key Takeaways</h1>
            
            <h2>Why Gradient Checkpointing Matters for Medical Imaging</h2>
            
            <div style="font-size: 1.3em; line-height: 2;">
                <p>‚úÖ <strong>Enables processing of clinical-resolution volumes</strong></p>
                <p>‚úÖ <strong>2-4√ó larger volumes on same hardware</strong></p>
                <p>‚úÖ <strong>No accuracy loss - identical gradients</strong></p>
                <p>‚úÖ <strong>30% speed trade-off is acceptable for memory gains</strong></p>
                <p>‚úÖ <strong>Essential for 3D architectures (U-Net, V-Net)</strong></p>
            </div>
            
            <h3>Getting Started</h3>
            <ol style="font-size: 1.2em; line-height: 1.8;">
                <li>Profile your model's memory usage</li>
                <li>Identify memory bottlenecks (usually encoder/bottleneck)</li>
                <li>Apply checkpointing selectively</li>
                <li>Combine with mixed precision for maximum benefit</li>
                <li>Monitor training speed vs memory trade-off</li>
            </ol>
            
            <p style="text-align: center; margin-top: 40px; font-size: 1.4em; color: #0066cc;">
                <strong>Ready to train on larger medical volumes? Start checkpointing today!</strong>
            </p>
        </div>

        <!-- Navigation -->
        <div class="navigation">
            <button class="nav-btn" id="prevBtn" onclick="changeSlide(-1)">Previous</button>
            <span class="slide-counter">
                <span id="currentSlide">1</span> / <span id="totalSlides">10</span>
            </span>
            <button class="nav-btn" id="nextBtn" onclick="changeSlide(1)">Next</button>
        </div>
    </div>

    <script>
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;

        document.getElementById('totalSlides').textContent = totalSlides;

        function showSlide(n) {
            slides.forEach(slide => slide.classList.remove('active'));
            
            currentSlide = (n + totalSlides) % totalSlides;
            
            slides[currentSlide].classList.add('active');
            document.getElementById('currentSlide').textContent = currentSlide + 1;
            
            // Update navigation buttons
            document.getElementById('prevBtn').disabled = currentSlide === 0;
            document.getElementById('nextBtn').disabled = currentSlide === totalSlides - 1;
        }

        function changeSlide(direction) {
            showSlide(currentSlide + direction);
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') changeSlide(-1);
            if (e.key === 'ArrowRight') changeSlide(1);
        });

        // Initialize
        showSlide(0);
    </script>
</body>
</html>